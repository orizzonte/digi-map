System.register("digi-map/src/map.component",["@angular/core","esri-mods","./identify/map.identify.component","./draw/map.draw.component","./edit/map.edit.component"],function(a,b){"use strict";var c,d,e,f,g,h,i,j=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),k=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a}],execute:function(){h=function(){function a(a,b){this.name=a,this.control=b}return a}(),a("MapControl",h),i=function(){function a(a){this.elRef=a,this.mapLoaded=new c.EventEmitter,this.themes=[],this.controls=[],this.useIdentifyControl=!1,this.useDrawControl=!1,this.useEditControl=!1}return a.prototype.ngAfterViewInit=function(){this.useIdentifyControl&&this.controls.push(new h("identify",this.identify)),this.useDrawControl&&this.controls.push(new h("draw",this.draw)),this.useEditControl&&this.controls.push(new h("edit",this.edit))},a.prototype.ngOnInit=function(){var a=this,b=this;this.currentMap=new d.map("map"),-1!==this.settings.controls.indexOf("identify")&&(this.useIdentifyControl=!0),-1!==this.settings.controls.indexOf("draw")&&(this.useDrawControl=!0),-1!==this.settings.controls.indexOf("edit")&&(this.useEditControl=!0),this.currentMap.on("layers-add-result",function(a){var c=[];a.layers.forEach(function(a,b){var d=a.layer.layerInfos;d&&d.length>0&&c.push({layer:a.layer,title:a.layer.name})});var e=new d.Legend({map:b.currentMap,respectCurrentMapScale:!1,layerInfos:c},"legend");e.startup()}),void 0!==this.settings.themes&&(this.settings.themes.forEach(function(b){"dynamic"===b.type?a.themes.push(new d.ArcGISDynamicMapServiceLayer(b.url)):a.themes.push(new d.ArcGISTiledMapServiceLayer(b.url))}),this.currentMap.addLayers(this.themes)),void 0!==this.settings.extent&&(this.initialExtent=new d.Extent({xmin:this.settings.extent[0],ymin:this.settings.extent[1],xmax:this.settings.extent[2],ymax:this.settings.extent[3],spatialReference:new d.SpatialReference({wkid:31370})}),this.currentMap.setExtent(this.initialExtent)),this.currentMap.on("load",function(a){console.log("map loaded")})},a.prototype.toInitialExtent=function(){this.currentMap.setExtent(this.initialExtent)},j([c.Input(),k("design:type",Object)],a.prototype,"settings",void 0),j([c.Output(),k("design:type",Object)],a.prototype,"mapLoaded",void 0),j([c.ViewChild(e.MapIdentifyComponent),k("design:type",e.MapIdentifyComponent)],a.prototype,"identify",void 0),j([c.ViewChild(f.MapDrawComponent),k("design:type",f.MapDrawComponent)],a.prototype,"draw",void 0),j([c.ViewChild(g.MapEditComponent),k("design:type",g.MapEditComponent)],a.prototype,"edit",void 0),a=j([c.Component({selector:"esri-map",template:' <div id="map">\n                    <map-identify *ngIf="useIdentifyControl" [mapInstance]="currentMap" [settings]="settings"></map-identify>\n                    <map-draw *ngIf="useDrawControl" [mapInstance]="currentMap"></map-draw>\n                    <map-edit *ngIf="useEditControl" [mapInstance]="currentMap"></map-edit>\n                    <ng-content></ng-content>\n                </div>',directives:[e.MapIdentifyComponent,f.MapDrawComponent,g.MapEditComponent]}),k("design:paramtypes",[c.ElementRef])],a)}(),a("MapComponent",i)}}}),System.register("digi-map/src/componentbuilder/custom.component.builder",["@angular/core"],function(a,b){"use strict";var c,d,e=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),f=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a}],execute:function(){d=function(){function a(){}return a.prototype.CreateComponent=function(a,b){var d=function(){function d(){}return d.prototype.toArray=function(a){var b=[];for(var c in a)!c||c.startsWith("SHAPE")||c.startsWith("OBJECTID")||b.push({key:c,value:a[c]});return b},d=e([c.Component({selector:"dynamic-component",template:a,directives:b}),f("design:paramtypes",[])],d)}();return d},a}(),a("CustomComponentBuilder",d)}}}),System.register("digi-map/src/componentbuilder/dynamic.component.holder",["@angular/core","@angular/common","./custom.component.builder"],function(a,b){"use strict";var c,d,e,f,g,h=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),i=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a,d=a},function(a){e=a},function(a){f=a}],execute:function(){g=function(){function a(a,b){this.componentResolver=a,this.customComponentBuilder=b}return a.prototype.ngOnChanges=function(){this.component&&(this.component.title=this.title,this.component.entity=this.entity)},a.prototype.ngOnInit=function(){var a=this,b=this.customComponentBuilder.CreateComponent(this.template,e.FORM_DIRECTIVES);this.componentResolver.resolveComponent(b).then(function(b){var c=a.dynamicComponentTarget.createComponent(b,0);a.component=c.instance,a.component.title=a.title,a.component.entity=a.entity})},h([c.Input(),i("design:type",Object)],a.prototype,"entity",void 0),h([c.Input(),i("design:type",String)],a.prototype,"title",void 0),h([c.Input(),i("design:type",String)],a.prototype,"template",void 0),h([d.ViewChild("dynamicContentPlaceHolder",{read:d.ViewContainerRef}),i("design:type",d.ViewContainerRef)],a.prototype,"dynamicComponentTarget",void 0),a=h([c.Component({selector:"dynamic-holder",template:"\n<div>  \n  <div #dynamicContentPlaceHolder></div>  \n</div>\n",providers:[f.CustomComponentBuilder]}),i("design:paramtypes",[d.ComponentResolver,f.CustomComponentBuilder])],a)}(),a("DynamicHolder",g)}}}),System.register("digi-map/src/identify/map.identify.results.component",["@angular/core","../componentbuilder/dynamic.component.holder"],function(a,b){"use strict";var c,d,e,f=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),g=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(){}return a.prototype.ngOnInit=function(){this.results&&this.results.length>0&&(this.currentResult=this.results[0]),this.settings&&this.settings.template&&""!==this.settings.template?this.detailTemplate=this.settings.template:this.detailTemplate='\n                <ul>\n                    <li *ngFor="let attribute of toArray(entity.feature.attributes)">\n                        {{attribute?.key}} : {{attribute?.value}}\n                    </li>\n                </ul>'},a.prototype.ngOnChanges=function(){this.currentResult=void 0,this.results&&this.results.length>0&&(this.currentResult=this.results[0])},a.prototype.resultName=function(a){return a.layerName+": "+a.value},a.prototype.selectResult=function(a){this.currentResult=this.results[a]},f([c.Input(),g("design:type",Object)],a.prototype,"settings",void 0),f([c.Input(),g("design:type",Object)],a.prototype,"results",void 0),f([c.Input(),g("design:type",String)],a.prototype,"detailTemplate",void 0),a=f([c.Component({selector:"digi-identify-results",template:' <div style="display:none">\n                    <div id="popup-content">\n                        <div *ngIf="results && results.length>0">\n                            <select (change)="selectResult($event.target.value)" *ngIf="results.length>1">\n                                <option *ngFor="let result of results; let i=index" [value]="i">{{resultName(result)}}</option>                           \n                            </select>                     \n\n                            <div>\n                                <dynamic-holder [entity]="currentResult" [title]="\'Details details\'" [template]="detailTemplate" *ngIf="currentResult"></dynamic-holder>                            \n                            </div> \n                        </div> \n                        <div *ngIf="results && results.length==0">Geen gegevens gevonden</div>                   \n                    </div>\n                </div>',directives:[d.DynamicHolder]}),g("design:paramtypes",[])],a)}(),a("IdentifyResultsComponent",e)}}}),System.register("digi-map/src/identify/map.identify.component",["@angular/core","esri-mods","../componentbuilder/dynamic.component.holder","./map.identify.results.component"],function(a,b){"use strict";var c,d,e,f,g,h=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),i=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a}],execute:function(){g=function(){function a(){this.isActive=!1,this.results=[]}return a.prototype.ngOnInit=function(){var a=this;this.settings&&this.settings.identify||(this.isActive=!1),this.infoWindow=new d.InfoWindowLite(null,"popup"),this.infoWindow.startup(),this.mapInstance.infoWindow=this.infoWindow,this.infoWindow.resize(this.settings.identify.width||310,this.settings.identify.height||350),this.mapInstance.on("click",function(b){if(a.isActive){var c=[],e=a;a.settings.identify.urls.forEach(function(a){var f=new d.IdentifyTask(a),g=new d.IdentifyParameters;g.tolerance=3,g.returnGeometry=!0,g.layerOption=d.IdentifyParameters.LAYER_OPTION_VISIBLE,g.geometry=b.mapPoint,g.mapExtent=e.mapInstance.extent,f.execute(g).addCallback(function(a){console.log("reposnse: "+JSON.stringify(a)),a.forEach(function(a){c.push(a)}),e.results=c})}),a.infoWindow.setTitle(a.settings.identify.title||"Details"),a.infoWindow.setContent(document.getElementById("popup-content")),a.infoWindow.show(b.mapPoint)}})},a.prototype.onClick=function(){this.isActive=!this.isActive,this.infoWindow.hide()},h([c.Input(),i("design:type",d.map)],a.prototype,"mapInstance",void 0),h([c.Input(),i("design:type",Object)],a.prototype,"settings",void 0),a=h([c.Component({selector:"map-identify",template:"	<div class='map-identify'>\n					<button (click)='onClick()' [class.active]='isActive'>Detailgegevens</button>\n			  	</div>\n			  	<div id='popup'></div>\n				<digi-identify-results [results]='results' *ngIf=\"results\" [settings]=\"settings.identify\"></digi-identify-results>",styles:[".map-identify button { z-index: 99999999999; }",".active { background-color: green; color: white; }"],directives:[e.DynamicHolder,f.IdentifyResultsComponent]}),i("design:paramtypes",[])],a)}(),a("MapIdentifyComponent",g)}}}),System.register("digi-map/src/draw/map.draw.component",["@angular/core","esri-mods","rxjs/Rx"],function(a,b){"use strict";var c,d,e,f,g,h=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),i=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a},function(a){d=a},function(a){e=a}],execute:function(){!function(a){a[a.Point=1]="Point",a[a.Multiline=2]="Multiline"}(f||(f={})),a("GeometryType",f),g=function(){function a(){this.activateSubject=new e.Subject,this.deactivateSubject=new e.Subject,this.drawCompleteSubject=new e.Subject,this.onActivate=this.activateSubject.asObservable(),this.onDeactivate=this.deactivateSubject.asObservable(),this.onDrawComplete=this.drawCompleteSubject.asObservable()}return a.prototype.ngOnInit=function(){var a=this;this.drawToolbar=new d.draw(this.mapInstance),this.drawToolbar.on("draw-complete",function(b){var c;switch(b.geometry.type){case"polyline":c=new d.SimpleLineSymbol;break;default:c=new d.SimpleFillSymbol}var e=new d.graphic(b.geometry,c);a.mapInstance.graphics.add(e),a.deactivate(),a.drawCompleteSubject.next(b)})},a.prototype.activate=function(a){switch(a){case f.Multiline:this.drawToolbar.activate(d.draw.POLYLINE)}this.activateSubject.next(null)},a.prototype.deactivate=function(){this.drawToolbar.deactivate(),this.deactivateSubject.next(null)},a.prototype.finishDrawing=function(){this.drawToolbar.finishDrawing()},h([c.Input(),i("design:type",d.map)],a.prototype,"mapInstance",void 0),a=h([c.Component({selector:"map-draw",template:"<div></div>"}),i("design:paramtypes",[])],a)}(),a("MapDrawComponent",g)}}}),System.register("digi-map/src/edit/map.edit.component",["@angular/core","esri-mods","rxjs/Rx"],function(a,b){"use strict";var c,d,e,f,g=(b&&b.id,this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}),h=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){c=a},function(a){d=a},function(a){e=a}],execute:function(){f=function(){function a(){this.activateSubject=new e.Subject,this.deactivateSubject=new e.Subject,this.onActivate=this.activateSubject.asObservable(),this.onDeactivate=this.deactivateSubject.asObservable()}return a.prototype.ngOnInit=function(){this.editToolbar=new d.edit(this.mapInstance)},a.prototype.activate=function(){var a=this.mapInstance.graphics.graphics[0];this.editToolbar.activate(d.edit.EDIT_VERTICES,a),this.activateSubject.next(null)},a.prototype.deactivate=function(){this.editToolbar.deactivate(),this.deactivateSubject.next(null)},g([c.Input(),h("design:type",d.map)],a.prototype,"mapInstance",void 0),a=g([c.Component({selector:"map-edit",template:"<div></div>"}),h("design:paramtypes",[])],a)}(),a("MapEditComponent",f)}}}),System.registerDynamic("empty",[],!1,function(a,b,c){var d=System.get("@@global-helpers").prepareGlobal(c.id,null,null);return d()}),System.register("digi-map/digi-map",["./src/map.component","./src/identify/map.identify.component","./src/draw/map.draw.component","./src/edit/map.edit.component","esri-mods"],function(a,b){"use strict";function c(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)}b&&b.id;return{setters:[function(a){c(a)},function(a){c(a)},function(a){c(a)},function(a){c(a)},function(a){c(a)}],execute:function(){}}});
//# sourceMappingURL=digi-map.min.js.map